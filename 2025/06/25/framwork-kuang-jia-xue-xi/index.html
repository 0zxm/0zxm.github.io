<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Django REST framwork框架学习 | 0zxm</title><meta name="author" content="0zxm"><meta name="copyright" content="0zxm"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Django拓展框架Django-REST-framwork的简单笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Django REST framwork框架学习">
<meta property="og:url" content="https://0zxm.github.io/2025/06/25/framwork-kuang-jia-xue-xi/index.html">
<meta property="og:site_name" content="0zxm">
<meta property="og:description" content="Django拓展框架Django-REST-framwork的简单笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://0zxm.github.io/img/default_cover.jpg">
<meta property="article:published_time" content="2025-06-25T13:09:01.000Z">
<meta property="article:modified_time" content="2025-06-29T03:37:07.313Z">
<meta property="article:author" content="0zxm">
<meta property="article:tag" content="python">
<meta property="article:tag" content="web框架">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://0zxm.github.io/img/default_cover.jpg"><link rel="shortcut icon" href="/favicon.png"><link rel="canonical" href="https://0zxm.github.io/2025/06/25/framwork-kuang-jia-xue-xi/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: 0zxm","link":"链接: ","source":"来源: 0zxm","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Django REST framwork框架学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-29 11:37:07'
}</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/src/"><i class="fa-fw fas fa-cloud"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/default_cover.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">0zxm</span></a><a class="nav-page-title" href="/"><span class="site-name">Django REST framwork框架学习</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/src/"><i class="fa-fw fas fa-cloud"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/shuoshuo/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Django REST framwork框架学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-25T13:09:01.000Z" title="发表于 2025-06-25 21:09:01">2025-06-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-29T03:37:07.313Z" title="更新于 2025-06-29 11:37:07">2025-06-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/web%E5%BC%80%E5%8F%91/">web开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">11.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>46分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/">Home - Django REST framework官方文档</a></p>
<h2 id="0-为什么会有DRF"><a href="#0-为什么会有DRF" class="headerlink" title="0.为什么会有DRF"></a>0.为什么会有DRF</h2><p>该部分的理解参考了此篇博客<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53957464">一图看懂Django和DRF - 知乎</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic4.zhimg.com/v2-4d9b4934f3547d4a6571652f07d94fd7_1440w.jpg"></p>
<p>Django模板原生是为了进行前后端不分离的全栈开发，而前后端分离是一种现代化的开发模式和架构模式，旨在通过将前端和后端的职责分离来提升开发效率、系统性能和可维护性。DRF就是专为前后端分离架构来设计的一套WebAPI的框架。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/06/25/framwork-kuang-jia-xue-xi/v2-4ff17037c00b32608eed4f34245068a9_1440w.jpg" alt="img"></p>
<p>DRF是Django的超集，去掉了模板的部分，提供了一个REST风格的接口，同时也提供了满足该接口的代码工作流。同时，在REST的规范下，升级了权限和分页等功能，增加了限流和过滤搜索等功能。</p>
<h3 id="0-1-环境配置"><a href="#0-1-环境配置" class="headerlink" title="0.1 环境配置"></a>0.1 环境配置</h3><p>首先，使用pip下载第三方依赖包</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> djangorestframework
pip <span class="token function">install</span> markdown       <span class="token comment"># Markdown support for the browsable API.</span>
pip <span class="token function">install</span> django-filter  <span class="token comment"># Filtering support</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>然后在Django的settings.py中注册<code>rest_framwork</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'rest_framework'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果您打算使用<code>可浏览的API，</code>您可能还需要添加 REST 框架的登录和注销视图。将以下内容添加到您的根文件<code>urls.py</code>中</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    path<span class="token punctuation">(</span><span class="token string">'api-auth/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'rest_framework.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>请注意，URL 路径可以是您想要的任何路径。</p>
<p>REST 框架 API 的任何全局设置都保存在名为<code>settings.py</code>的文件，首先将以下内容添加到您的模块中：</p>
<pre class="line-numbers language-none"><code class="language-none">REST_FRAMEWORK &#x3D; &#123;
    # Use Django&#39;s standard &#96;django.contrib.auth&#96; permissions,
    # or allow read-only access for unauthenticated users.
    &#39;DEFAULT_PERMISSION_CLASSES&#39;: [
        &#39;rest_framework.permissions.DjangoModelPermissionsOrAnonReadOnly&#39;
    ]
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们现在已准备好创建我们的 API。 这是我们项目的根模块：<code>urls.py</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> routers<span class="token punctuation">,</span> serializers<span class="token punctuation">,</span> viewsets

<span class="token comment"># Serializers define the API representation.</span>
<span class="token keyword">class</span> <span class="token class-name">UserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>HyperlinkedModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">'is_staff'</span><span class="token punctuation">]</span>

<span class="token comment"># ViewSets define the view behavior.</span>
<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

<span class="token comment"># Routers provide an easy way of automatically determining the URL conf.</span>
router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">)</span>

<span class="token comment"># Wire up our API using automatic URL routing.</span>
<span class="token comment"># Additionally, we include login URLs for the browsable API.</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'api-auth/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'rest_framework.urls'</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'rest_framework'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在，您可以在浏览器中打开 <a target="_blank" rel="noopener" href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> API，并查看新的“用户”API。如果您使用右上角的登录控件，您还可以从系统中添加、创建和删除用户。</p>
<h3 id="0-2-API文档的自动生成"><a href="#0-2-API文档的自动生成" class="headerlink" title="0.2 API文档的自动生成"></a>0.2 API文档的自动生成</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_16240085/article/details/107712667">django rest framework 使用api接口文档_django自带的api接口文档-CSDN博客</a></p>
<p>如何自定义视图的文档说明?</p>
<p>只需要在对应的APIView或者ViewSet中添加注释，DRF会自动识别注释里面的内容添加到对应的接口文档中的方法说明。</p>
<ul>
<li>假如没有方法如(list: create:)这些，将会将下面的文字应用到所有的接口。</li>
<li>假如有以下格式，将会按照对应的接口来生成文档说明。</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BookInfoViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    list:
    返回所有图书

    create:
    创建图书

    retrieve:
    返回指定图书

    update:
    更新指定图书

    partial_update:
    部分更新指定图书

    destroy:
    删除指定图书
    """</span>
    queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 指定视图集使用的查询集</span>
    serializer_class <span class="token operator">=</span> BookSerializer   <span class="token comment"># 指定该视图集使用的序列化器</span>

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token comment"># 生成的路由就是这样的：/books/get_book_author_list/?author=Tom</span>
    <span class="token keyword">def</span> <span class="token function">get_book_author_list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        author <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'author'</span><span class="token punctuation">)</span>
        book_list <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>author__name<span class="token operator">=</span>author<span class="token punctuation">)</span>
        seri_data <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>book_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>seri_data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/06/25/framwork-kuang-jia-xue-xi/image-20250629112218277.png" alt="image-20250629112218277" style="zoom: 67%;">

<h2 id="1-改进的特点-序列化和视图"><a href="#1-改进的特点-序列化和视图" class="headerlink" title="1.改进的特点 - 序列化和视图"></a>1.改进的特点 - 序列化和视图</h2><h3 id="1-1-序列化"><a href="#1-1-序列化" class="headerlink" title="1.1 序列化"></a>1.1 序列化</h3><p>首先什么是序列化和反序列化? 在我的理解中，因为在网络上传输的是字符串，需要将对象和其属性转化成对应的字符串，所以就是用序列器ModelSerializer来对模型对象转成字典来处理（也就是所谓的序列化），否则的话就是调用原生的<code>__str__</code>方法</p>
<blockquote>
<p>”<em>序列化（Serialization）是一种将数据结构或对象的状态转换成一种可以存储或传输的形式的过程。通过序列化，可以将复杂的数据结构（如对象、数组、字典等）转化为字符串或二进制格式，以便将其保存到文件、数据库中，或者通过网络在不同的系统之间传递。序列化的逆过程称为<strong>反序列化（Deserialization）</strong>，即将序列化后的数据还原为原始的数据结构或对象。</em>“</p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>场景</strong></th>
<th><strong>原生 Django</strong></th>
<th><strong>DRF 序列化器</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>默认输出格式</strong></td>
<td>调用 <code>__str__</code> 方法（字符串）</td>
<td>自定义字段结构（字典 &#x2F; 列表）</td>
</tr>
<tr>
<td><strong>关联对象处理</strong></td>
<td>需手动访问关联字段（如 <code>book.author.name</code>）</td>
<td>使用 <code>PrimaryKeyRelatedField</code> 等自动处理</td>
</tr>
<tr>
<td><strong>数据类型转换</strong></td>
<td>需在模板中手动格式化（如日期）</td>
<td>自动处理序列化（如日期转字符串）</td>
</tr>
<tr>
<td><strong>API 响应</strong></td>
<td>需手动构建字典 &#x2F; JSON</td>
<td>自动生成符合 REST 规范的响应</td>
</tr>
</tbody></table>
<p>那就让我们来简单的实现一个序列化器：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># models.py中创建的模型字段</span>
<span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>to<span class="token operator">=</span>Author<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>
    
<span class="token comment"># 应用中新建serializers.py来创建具体的模型序列化器</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""图书数据序列化器"""</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book  <span class="token comment"># 指定该序列化器对应的模型</span>
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>  <span class="token comment"># 序列化该模型的所有字段</span>
      
<span class="token comment"># 在视图函数中尝试打印一个序列化后的对象看看</span>
<span class="token comment"># 测试序列化器的函数</span>
<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    book <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 获取一个图书对象</span>
    serializer <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>book<span class="token punctuation">)</span>  <span class="token comment"># 创建序列化器对象</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token comment"># 输出序列化后的数据</span>

    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
最后输出  &#123;'id': 1, 'title': '水浒传', 'author': 1&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-2-Serializer序列化器的简单使用"><a href="#1-2-Serializer序列化器的简单使用" class="headerlink" title="1.2 Serializer序列化器的简单使用"></a>1.2 Serializer序列化器的简单使用</h3><p>参考博客 <a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_48173416/article/details/139612906">Django REST framework序列化器详解：普通序列化器与模型序列化器的选择与运用_django序列化器-CSDN博客</a></p>
<h4 id="a-创建序列化器对象"><a href="#a-创建序列化器对象" class="headerlink" title="a. 创建序列化器对象"></a>a. 创建序列化器对象</h4><p>定义好序列化器类之后，可以通过以下方式创建序列化器对象：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>book<span class="token punctuation">)</span>  <span class="token comment"># 用于序列化对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>Serializer</code> 类的构造方法是：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Serializer<span class="token punctuation">(</span>instance<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> data<span class="token operator">=</span>empty<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>instance</code> 用于传入需要序列化的模型实例。</li>
<li><code>data</code> 用于传入需要反序列化的JSON数据。</li>
<li><code>context</code> 参数用于传递额外的数据（如请求对象），可以在序列化器内部使用。</li>
</ul>
<p>例如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>book<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'request'</span><span class="token punctuation">:</span> request<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="b-基本操作"><a href="#b-基本操作" class="headerlink" title="b. 基本操作"></a>b. 基本操作</h4><p>例如，查询一个图书对象并进行序列化：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> booktest<span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 获取一个图书对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>接下来，创建序列化器并获取序列化后的数据：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> booktest<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>book<span class="token punctuation">)</span>  <span class="token comment"># 创建序列化器对象</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token comment"># 输出序列化后的数据</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>输出结果类似：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"btitle"</span><span class="token operator">:</span> <span class="token string">"天龙八部"</span><span class="token punctuation">,</span>
    <span class="token property">"bpub_date"</span><span class="token operator">:</span> <span class="token string">"1986-07-24"</span><span class="token punctuation">,</span>
    <span class="token property">"bread"</span><span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
    <span class="token property">"bcomment"</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
    <span class="token property">"image"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果需要序列化多个对象（如查询集），可以通过设置 <code>many=True</code> 来进行：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">book_qs <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取所有图书</span>
serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>book_qs<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 序列化多个对象</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""或者说处理多对多关系   一个文章可以有多个标签tag"""</span>
<span class="token keyword">class</span> <span class="token class-name">ArticleSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tags <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>
        many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 允许多个标签 ID</span>
        queryset<span class="token operator">=</span>Tag<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
<span class="token comment"># 接收数据: &#123;"tags": [1, 3, 5]&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>输出结果类似：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"btitle"</span><span class="token operator">:</span> <span class="token string">"天龙八部"</span><span class="token punctuation">,</span>
        <span class="token property">"bpub_date"</span><span class="token operator">:</span> <span class="token string">"1986-07-24"</span><span class="token punctuation">,</span>
        <span class="token property">"bread"</span><span class="token operator">:</span> <span class="token number">36</span><span class="token punctuation">,</span>
        <span class="token property">"bcomment"</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
        <span class="token property">"image"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">"btitle"</span><span class="token operator">:</span> <span class="token string">"笑傲江湖"</span><span class="token punctuation">,</span>
        <span class="token property">"bpub_date"</span><span class="token operator">:</span> <span class="token string">"1990-05-01"</span><span class="token punctuation">,</span>
        <span class="token property">"bread"</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token property">"bcomment"</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span>
        <span class="token property">"image"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="c-关联对象嵌套序列化"><a href="#c-关联对象嵌套序列化" class="headerlink" title="c.关联对象嵌套序列化"></a>c.关联对象嵌套序列化</h4><p>如果模型中包含关联字段（如外键），比如说你将Book对象进行序列化的时候还希望知道有关外键（作者）的其他信息，我们可以使用以下方式对关联对象进行序列化。</p>
<ul>
<li><h5 id="PrimaryKeyRelatedField-默认的序列化方式"><a href="#PrimaryKeyRelatedField-默认的序列化方式" class="headerlink" title="PrimaryKeyRelatedField (默认的序列化方式)"></a>PrimaryKeyRelatedField (默认的序列化方式)</h5></li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
当你查询一本书时，API 通常会返回作者的 ID（比如 author_id=2），而不是整个作者对象的详细信息。这就是 PrimaryKeyRelatedField 做的事情：用主键（ID）表示关联关系。
"""</span>
<span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Author<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
如果直接序列化 Book 对象，默认会返回：
&#123;
    "id": 1,
    "title": "Python Crash Course",
    "author": 2  # 作者的 ID
&#125;

但是无法做到以下操作，因为还只是进行了单表查询
- 验证这个 author=2 是否真的存在于数据库中。
- 创建新书时，通过 author=2 自动关联对应的作者对象。
这就是 PrimaryKeyRelatedField 的核心作用：验证主键，并处理关联关系。

但是假如我们指定了PrimaryKeyRelatedField
"""</span>
<span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 指定 author 字段使用 PrimaryKeyRelatedField</span>
    author <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>queryset<span class="token operator">=</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">]</span>
       
<span class="token triple-quoted-string string">"""在序列化的时候可能作用不是很明显"""</span>
book <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
serializer <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>book<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token comment"># 输出: &#123;'id': 1, 'title': 'Python', 'author': 2&#125;</span>

<span class="token triple-quoted-string string">"""但是在反序列化的时候十分有用  反序列化（从 JSON 到模型）"""</span>

<span class="token comment"># 客户端提交的数据</span>
data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"title"</span><span class="token punctuation">:</span> <span class="token string">"New Book"</span><span class="token punctuation">,</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token number">2</span>  <span class="token comment"># 假设作者 ID=2 存在</span>
<span class="token punctuation">&#125;</span>

serializer <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
<span class="token keyword">if</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 在此处就会判断对应的author是否存在</span>
    book <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自动关联 ID=2 的作者</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span>  <span class="token comment"># 输出: "John Doe"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>参数：</p>
<ul>
<li><p><code>queryset</code>参数 用于对关联的对象集进行一些条件限制 </p>
</li>
<li><p><code>many=True</code>参数，用于序列化多个对象</p>
</li>
<li><p><code>label</code>属性，主要在API文档、表单渲染或错误信息中作为字段的显示名称。</p>
</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""queryset限制条件"""</span>
<span class="token comment"># 只允许关联已激活的作者</span>
author <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>
    queryset<span class="token operator">=</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>is_active<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token triple-quoted-string string">"""label属性使用"""</span>
<span class="token keyword">class</span> <span class="token class-name">MySerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 显式指定 label</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"电子邮箱"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 也可以在 ModelSerializer 中使用</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'email'</span><span class="token punctuation">]</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'label'</span><span class="token punctuation">:</span> <span class="token string">'用户名'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token string">'email'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'label'</span><span class="token punctuation">:</span> <span class="token string">'电子邮箱'</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>StringRelatedField</strong></li>
</ul>
<p>将关联对象序列化为其 <code>__str__</code> 方法的返回值（对象的字符串表示形式）。<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/666103069">掌握Python中_<em>str</em>_()方法的实用技巧 - 知乎</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">hbook <span class="token operator">=</span> serializers<span class="token punctuation">.</span>StringRelatedField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'图书'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>HyperlinkedRelatedField</strong></li>
</ul>
<p>该字段将关联对象序列化为一个超链接（URL），指向该对象的详细页面。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">hbook <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedRelatedField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'图书'</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> view_name<span class="token operator">=</span><span class="token string">'books-detail'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>view_name</code> 必须指定为视图的名称，以便 DRF 可以找到对应的路由并生成URL。</p>
<ul>
<li><strong>SlugRelatedField</strong></li>
</ul>
<p>该字段将关联对象序列化为指定字段的数据。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">hbook <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SlugRelatedField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'图书'</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> slug_field<span class="token operator">=</span><span class="token string">'bpub_date'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>使用自定义序列化器</strong></li>
</ul>
<p>我们还可以通过自定义序列化器来序列化关联对象。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">hbook <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>重写 <code>to_representation</code> 方法</strong></li>
</ul>
<p>通过重写 <code>to_representation</code> 方法，我们可以自定义如何序列化字段数据。比如，我们可以自定义一个关联字段来输出不同格式的数据：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BookRelateField</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>RelatedField<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""自定义图书字段的序列化"""</span>
    <span class="token keyword">def</span> <span class="token function">to_representation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'Book: %d %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span> value<span class="token punctuation">.</span>btitle<span class="token punctuation">)</span>

hbook <span class="token operator">=</span> BookRelateField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-3-反序列化"><a href="#1-3-反序列化" class="headerlink" title="1.3 反序列化"></a>1.3 反序列化</h3><h4 id="a-验证"><a href="#a-验证" class="headerlink" title="a.验证"></a><strong>a.验证</strong></h4><p>使用序列化器进行反序列化时，需要对数据进行验证后，才能获取验证成功的数据或保存成模型类对象。</p>
<p>在获取反序列化的数据前，必须调用**is_valid()**方法进行验证，验证成功返回True，否则返回False。</p>
<p>验证失败，可以通过序列化器对象的<strong>errors</strong>属性获取错误信息，返回字典，包含了字段和字段的错误。如果是非字段错误，可以通过修改REST framework配置中的<strong>NON_FIELD_ERRORS_KEY</strong>来控制错误字典中的键名。</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/information/%E4%BD%BF%E7%94%A8django%E7%9A%84%E5%90%8E%E7%AB%AF%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF">使用django的后端验证错误消息 - 腾讯云开发者社区 - 腾讯云</a>具体的有关字段错误和非字段错误可以自行搜索一下。</p>
<p>验证成功，可以通过序列化器对象的<strong>validated_data</strong>属性获取数据。</p>
<p>在定义序列化器时，指明每个字段的序列化类型和选项参数，本身就是一种验证行为。</p>
<p>is_valid()方法还可以在验证失败时抛出异常serializers.ValidationError，可以通过传递<strong>raise_exception&#x3D;True</strong>参数开启，REST framework接收到此异常，会向前端返回HTTP 400 Bad Request响应。</p>
<ul>
<li>当验证失败时，可以通过 <code>serializer.errors</code> 获取错误信息。错误信息以字典形式返回，包含了字段和字段的错误。</li>
<li>验证成功后，可以通过<code>serializer.validated_data</code> 获取验证后的数据。</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token comment"># 定义序列化器</span>
<span class="token keyword">class</span> <span class="token class-name">UserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>min_value<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span>

<span class="token comment"># 模拟传入的数据</span>
data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"this_is_too_long_for_the_field"</span><span class="token punctuation">,</span>  <span class="token comment"># 超过最大长度</span>
    <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">15</span>  <span class="token comment"># 未达到最小年龄</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># 序列化器实例</span>
serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token comment"># 验证数据</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"验证失败，错误信息："</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>

<span class="token comment"># 输出错误信息：</span>
<span class="token comment"># 验证失败，错误信息：</span>
<span class="token comment"># &#123;</span>
<span class="token comment">#     "username": ["Ensure this field has no more than 10 characters."],</span>
<span class="token comment">#     "age": ["Ensure this value is greater than or equal to 18."]</span>
<span class="token comment"># &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>使用 <code>raise_exception=True</code> 抛出异常</li>
</ul>
<p>当调用 <code>is_valid()</code> 时，传递 <code>raise_exception=True</code> 参数，会在验证失败时抛出 <code>serializers.ValidationError</code> 异常。对于 REST framework，这种异常会自动返回 HTTP 400 Bad Request 响应。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ValidationError

data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"invalid_user_name_because_it_is_too_long"</span><span class="token punctuation">,</span>
    <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">15</span>
<span class="token punctuation">&#125;</span>

serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token keyword">try</span><span class="token punctuation">:</span>
    serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> serializers<span class="token punctuation">.</span>ValidationError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"捕获到 ValidationError 异常！"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>

<span class="token comment"># 输出：</span>
<span class="token comment"># 捕获到 ValidationError 异常！</span>
<span class="token comment"># &#123;'username': ['Ensure this field has no more than 10 characters.'], 'age': ['Ensure this value is greater than or equal to 18.']&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2025/06/25/framwork-kuang-jia-xue-xi/image-20250626125120730.png" alt="image-20250626125120730"></p>
<ul>
<li>修改 <code>NON_FIELD_ERRORS_KEY</code></li>
</ul>
<p>如果需要自定义非字段错误的键名，可以在 REST framework 的全局配置中设置 <code>NON_FIELD_ERRORS_KEY</code>。</p>
<p><strong>修改配置：</strong></p>
<p>在 <code>settings.py</code> 中：</p>
<pre class="line-numbers language-none"><code class="language-none">REST_FRAMEWORK &#x3D; &#123;
    &#39;NON_FIELD_ERRORS_KEY&#39;: &#39;non_field_errors&#39;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">CustomSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">"用户名和密码不能相同"</span><span class="token punctuation">)</span>  <span class="token comment"># 这是一个非字段错误</span>
        <span class="token keyword">return</span> data

data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
    <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span>
<span class="token punctuation">&#125;</span>

serializer <span class="token operator">=</span> CustomSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token keyword">not</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>

<span class="token comment"># 输出：</span>
<span class="token comment"># &#123;'non_field_errors': ['用户名和密码不能相同']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="b-保存"><a href="#b-保存" class="headerlink" title="b.保存"></a><strong>b.保存</strong></h4><p>如果在验证成功后，想要基于validated_data完成数据对象的创建，可以通过实现create()和update()两个方法来实现。</p>
<ul>
<li><strong><code>create()</code> 方法</strong>：当调用 <code>save()</code> 时，如果序列化器在初始化时没有传递 <code>instance</code>，则会调用 <code>create()</code> 方法，用于创建新的对象。</li>
<li><strong><code>update()</code> 方法</strong>：当调用 <code>save()</code> 时，如果序列化器在初始化时传递了 <code>instance</code>，则会调用 <code>update()</code> 方法，用于更新现有对象。</li>
</ul>
<p><strong>示例代码：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">from rest_framework import serializers

# 定义一个简单的模型类
class User:
    def __init__(self, username, age):
        self.username &#x3D; username
        self.age &#x3D; age

# 定义序列化器
class UserSerializer(serializers.Serializer):
    username &#x3D; serializers.CharField(max_length&#x3D;10)
    age &#x3D; serializers.IntegerField(min_value&#x3D;18)

    # create 方法
    def create(self, validated_data):
        return User(**validated_data)  # 创建新的对象

    # update 方法
    def update(self, instance, validated_data):
        instance.username &#x3D; validated_data.get(&#39;username&#39;, instance.username)
        instance.age &#x3D; validated_data.get(&#39;age&#39;, instance.age)
        return instance

# 使用 create() 创建对象
data &#x3D; &#123;&quot;username&quot;: &quot;testuser&quot;, &quot;age&quot;: 25&#125;
serializer &#x3D; UserSerializer(data&#x3D;data)
if serializer.is_valid():
    user &#x3D; serializer.save()  # 调用 create() 方法
    print(&quot;创建的用户对象：&quot;, user.__dict__)

# 使用 update() 更新对象
existing_user &#x3D; User(username&#x3D;&quot;olduser&quot;, age&#x3D;30)
update_data &#x3D; &#123;&quot;username&quot;: &quot;updateduser&quot;&#125;
serializer &#x3D; UserSerializer(instance&#x3D;existing_user, data&#x3D;update_data, partial&#x3D;True)
if serializer.is_valid():
    updated_user &#x3D; serializer.save()  # 调用 update() 方法
    print(&quot;更新后的用户对象：&quot;, updated_user.__dict__)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>在 <code>save()</code> 时传递额外数据</li>
</ol>
<p>可以在调用 <code>save()</code> 方法时传递额外的数据，这些数据会被传递到 <code>create()</code> 或 <code>update()</code> 方法的 <code>validated_data</code> 参数中。</p>
<p><strong>示例代码：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">class UserSerializer(serializers.Serializer):
    username &#x3D; serializers.CharField(max_length&#x3D;10)
    age &#x3D; serializers.IntegerField(min_value&#x3D;18)

    def create(self, validated_data):
        # 获取额外传递的数据
        extra_info &#x3D; validated_data.pop(&#39;extra_info&#39;, None)
        print(&quot;额外信息：&quot;, extra_info)
        return User(**validated_data)

data &#x3D; &#123;&quot;username&quot;: &quot;newuser&quot;, &quot;age&quot;: 20&#125;
serializer &#x3D; UserSerializer(data&#x3D;data)
if serializer.is_valid():
    user &#x3D; serializer.save(extra_info&#x3D;&quot;This is extra data&quot;)  # 传递额外的数据，会添加到对应的validated_data字典中
    print(&quot;创建的用户对象：&quot;, user.__dict__)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>使用 <code>partial=True</code> 进行部分字段更新</li>
</ol>
<p>默认情况下，序列化器会对所有 <code>required=True</code> 的字段进行验证。如果只想更新部分字段，可以在创建序列化器时传递 <code>partial=True</code>，允许跳过未提供的字段的验证。</p>
<p><strong>示例代码：</strong></p>
<pre class="line-numbers language-none"><code class="language-none"># 使用 partial&#x3D;True 进行部分字段更新
existing_user &#x3D; User(username&#x3D;&quot;partialuser&quot;, age&#x3D;40)
update_data &#x3D; &#123;&quot;age&quot;: 45&#125;  # 仅更新部分字段
serializer &#x3D; UserSerializer(instance&#x3D;existing_user, data&#x3D;update_data, partial&#x3D;True)

if serializer.is_valid():
    updated_user &#x3D; serializer.save()
    print(&quot;部分更新后的用户对象：&quot;, updated_user.__dict__)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-4-模型序列化器"><a href="#1-4-模型序列化器" class="headerlink" title="1.4 模型序列化器"></a>1.4 模型序列化器</h3><p>参考博客 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38628046/article/details/129866800">Django REST Framework（DRF）框架之Serializer序列化器的使用</a></p>
<p>模型序列化器其实已经在上面的代码例子中演示过了，<code>ModelSerializer</code> 是 Django REST Framework (DRF) 提供的一个基于 Django 模型的序列化器。它可以让你快速创建一个与模型类相关联的序列化器，而无需手动为每个字段定义逻辑。</p>
<p>定义一个 <code>ModelSerializer</code> 很简单，继承自 <code>serializers.ModelSerializer</code> 并定义 <code>Meta</code> 类即可。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> myapp<span class="token punctuation">.</span>models <span class="token keyword">import</span> MyModel

<span class="token keyword">class</span> <span class="token class-name">MyModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> MyModel  <span class="token comment"># 指定对应的模型类</span>
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>  <span class="token comment"># 或指定具体字段列表</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="a-指定字段-Meta类的属性"><a href="#a-指定字段-Meta类的属性" class="headerlink" title="a. 指定字段-Meta类的属性"></a>a. 指定字段-Meta类的属性</h4><ol>
<li><strong>使用 <code>fields</code> 明确字段</strong></li>
</ol>
<p>使用 <code>fields</code> 属性可以指定序列化器要包含的字段，可以使用 <code>__all__</code> 表示包含模型的所有字段，也可以指定具体字段。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> MyModel
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'description'</span><span class="token punctuation">]</span>  <span class="token comment"># 指定具体字段</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><strong>使用 <code>exclude</code> 排除字段</strong></li>
</ol>
<p>使用 <code>exclude</code> 属性可以指定要排除的字段，<code>fields</code> 和 <code>exclude</code> 不能同时使用。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> MyModel
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'created_at'</span><span class="token punctuation">,</span> <span class="token string">'updated_at'</span><span class="token punctuation">]</span>  <span class="token comment"># 排除某些字段</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><strong>使用 <code>depth</code> 生成嵌套表示</strong></li>
</ol>
<p>默认情况下，<code>ModelSerializer</code> 使用主键（<code>id</code>）作为关联字段。如果需要嵌套表示，可以使用 <code>depth</code> 属性。<code>depth</code> 是一个整数，用来指明嵌套的层级数量。</p>
<p>注意：此时不要设置<code>PrimaryKeyRelatedField</code>等关联规则，否则序列化结果只包含<code>author</code>的id属性。</p>
<p><strong>示例：</strong></p>
<p>假设有两个模型：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Category</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Product</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>
    category <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Category<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>序列化器如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ProductSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Product
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        depth <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 嵌套层级为1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>序列化后的数据可能是：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Product A"</span><span class="token punctuation">,</span>
    <span class="token string">"category"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Category B"</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li><strong>显式指定字段</strong></li>
</ol>
<p>如果需要对某个字段进行特殊处理，可以在序列化器中显式自定义字段。例如：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BookSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    days_since_published <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SerializerMethodField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自定义只读字段,注意自定义字段只能使用SerializerMethodField()，否则就需要在__init__()方法中定制</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Book
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'pub_date'</span><span class="token punctuation">,</span> <span class="token string">'days_since_published'</span><span class="token punctuation">]</span>

    <span class="token comment"># get_加上你自定义的字段 就是序列器在序列化的时候计算的属性，obj参数就是传过来的book实例</span>
    <span class="token keyword">def</span> <span class="token function">get_days_since_published</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""计算书籍出版天数"""</span>
        <span class="token keyword">from</span> django<span class="token punctuation">.</span>utils <span class="token keyword">import</span> timezone
        <span class="token keyword">if</span> obj<span class="token punctuation">.</span>pub_date<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>timezone<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> obj<span class="token punctuation">.</span>pub_date<span class="token punctuation">)</span><span class="token punctuation">.</span>days
        <span class="token keyword">return</span> <span class="token boolean">None</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li><strong>指定只读字段</strong></li>
</ol>
<p>可以使用 <code>read_only_fields</code> 属性指定只读字段，这些字段仅用于序列化输出，不能用于反序列化输入。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> MyModel
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        read_only_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'created_at'</span><span class="token punctuation">]</span>  <span class="token comment"># 指定只读字段</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="b-添加额外参数"><a href="#b-添加额外参数" class="headerlink" title="b. 添加额外参数"></a>b. 添加额外参数</h4><p>在某些情况下，我们可能需要为序列化器的字段添加额外的选项或修改原有的字段行为，可以通过 <code>extra_kwargs</code> 实现。</p>
<ul>
<li>验证器内容拓展：<ul>
<li><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/zh-hans/5.2/ref/validators/">验证器 | Django documentation | Django</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaogongjin/p/13284335.html">DRF框架serializer反序列化校验之validators - 小公瑾 - 博客园</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40132294/article/details/125706528">DRF–validators检验函数,单字段校验,多字段联合校验_drf validate-CSDN博客</a></li>
<li><a target="_blank" rel="noopener" href="https://q1mi.github.io/Django-REST-framework-documentation/api-guide/validators_zh/">Validators - Django REST framework中文站点</a></li>
</ul>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyModelSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> MyModel
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'required'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'validators'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment"># 设置 name 字段为必填，并取消其验证器</span>
            <span class="token string">'description'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'max_length'</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment"># 设置 description 字段的最大长度</span>
        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="c-整合示例"><a href="#c-整合示例" class="headerlink" title="c. 整合示例"></a>c. 整合示例</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">from</span> myapp<span class="token punctuation">.</span>models <span class="token keyword">import</span> Category<span class="token punctuation">,</span> Product

<span class="token keyword">class</span> <span class="token class-name">ProductSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    category_name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'category.name'</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Product
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">,</span> <span class="token string">'category'</span><span class="token punctuation">,</span> <span class="token string">'category_name'</span><span class="token punctuation">]</span>
        read_only_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'required'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'min_value'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment"># 价格字段必须非负</span>
            <span class="token string">'category'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'write_only'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment"># 分类字段仅用于写入（反序列化）</span>
        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过 <code>ModelSerializer</code>，可以快速为模型类创建功能齐全的序列化器，同时保留灵活性以满足自定义需求。</p>
<h3 id="1-5-优化的Request和Response对象"><a href="#1-5-优化的Request和Response对象" class="headerlink" title="1.5 优化的Request和Response对象"></a>1.5 优化的Request和Response对象</h3><h4 id="a-Request对象"><a href="#a-Request对象" class="headerlink" title="a. Request对象"></a>a. Request对象</h4><p>在Django REST框架中，<code>request</code>对象已经不再是Django默认的<code>HttpRequest</code>对象，而是由REST框架提供的扩展版本，即<code>Request</code>对象。这个<code>Request</code>对象继承了<code>HttpRequest</code>，并加入了更多功能来处理API请求的数据。</p>
<p>当前端发起请求时，REST框架会根据请求的<code>Content-Type</code>（比如JSON、表单等）自动解析请求体中的数据。解析后，这些数据会以类字典对象的形式存储在<code>Request</code>对象中。这样，无论前端发送的数据格式是什么，我们都能通过统一的方式访问这些数据。</p>
<p><strong>常用的属性：</strong></p>
<ol>
<li><strong><code>request.data</code></strong><br> 这是请求体的数据。它的作用类似于Django中的<code>request.POST</code>和<code>request.FILES</code>，但是它有以下特点：</li>
</ol>
<ul>
<li>包含解析后的文件和非文件数据。</li>
<li>支持多种请求方式，如<code>POST</code>、<code>PUT</code>、<code>PATCH</code>等。</li>
<li>通过REST框架的解析器（<code>parsers</code>）解析，不仅支持表单数据，还支持JSON数据。</li>
</ul>
<ol start="2">
<li><strong><code>request.query_params</code></strong><br> 这个属性类似于Django中的<code>request.GET</code>，用于获取请求URL中的查询参数（即<code>?key=value</code>部分）。<code>request.query_params</code>只是REST框架对<code>request.GET</code>的改进，名字更准确一些。</li>
</ol>
<p>简而言之，<code>request.data</code>用于访问请求体的数据（比如表单数据或JSON），而<code>request.query_params</code>用于获取URL中的查询参数。这样，不论前端发送何种格式的数据，都可以统一通过这些属性来访问和处理请求数据。</p>
<h4 id="b-Response的对象"><a href="#b-Response的对象" class="headerlink" title="b. Response的对象"></a><strong>b. Response的对象</strong></h4><p>在 Django REST framework 中，<code>Response</code> 是一个用来构造 HTTP 响应的类。它会根据前端的实际需求自动将 Python 数据转换为适合的格式（比如 JSON、HTML 等）。这个转换过程是通过 <strong>渲染器（Renderer）</strong> 来完成的。</p>
<p><strong>响应的渲染机制</strong></p>
<p>通过前端请求中的 <code>Accept</code> 请求头，REST framework 会选择最佳的渲染器将数据转换为对应格式。如果前端未指定 <code>Accept</code>，系统会使用默认的渲染器来处理响应数据。默认渲染器可以在项目的配置中修改：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'DEFAULT_RENDERER_CLASSES'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>  
        <span class="token string">'rest_framework.renderers.JSONRenderer'</span><span class="token punctuation">,</span>  <span class="token comment"># JSON 渲染器（默认返回 JSON 格式数据）</span>
        <span class="token string">'rest_framework.renderers.BrowsableAPIRenderer'</span><span class="token punctuation">,</span>  <span class="token comment"># 可浏览的 API 页面渲染器</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>构造响应</strong></p>
<p><code>Response</code> 类的构造方法如下：</p>
<pre class="line-numbers language-none"><code class="language-none">Response(data, status&#x3D;None, template_name&#x3D;None, headers&#x3D;None, content_type&#x3D;None)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这里的 <code>data</code> 参数，只需要传入 <strong>Python 内置类型的数据</strong>（例如字典、列表、字符串等），而不需要是已经处理好的（渲染后的）数据。REST framework 会根据请求头和配置自动进行渲染。如果传入的是复杂结构（例如 Django 的模型对象），需要先通过 <strong>序列化器（Serializer）</strong> 转换为适合的格式（通常为字典）后再传递给 <code>data</code>。</p>
<p>参数说明：</p>
<ul>
<li><strong>data</strong>: 要返回的响应数据，必须是序列化后的 Python 内置类型（如字典、列表等）。</li>
<li><strong>status</strong>: HTTP 状态码，默认为 <code>200</code>（成功）。</li>
<li><strong>template_name</strong>: 如果渲染器是 <code>HTMLRenderer</code>，可指定使用的模板名称。</li>
<li><strong>headers</strong>: 一个字典，指定响应头信息。</li>
<li><strong>content_type</strong>: 响应的 <code>Content-Type</code>，通常无需指定，REST framework 会自动根据渲染数据类型生成。</li>
</ul>
<p><strong>常用属性</strong></p>
<ol>
<li><strong><code>.data</code></strong><br> 这个属性是传给 <code>Response</code> 的原始数据，还没有经过渲染器处理（也就是“尚未转换为最终响应格式”的数据）。例如，传入一个字典，它就是你未加工的字典。</li>
<li><strong><code>.status_code</code></strong><br> 响应的 HTTP 状态码，例如 <code>200</code> 表示成功，<code>404</code> 表示资源未找到。</li>
<li><strong><code>.content</code></strong><br> 这是最终处理完成的响应数据。它会经过渲染器的转换（例如转换为 JSON 格式字符串），最终成为 HTTP 响应体中返回的内容。</li>
</ol>
<h4 id="c-示例代码：简单演示"><a href="#c-示例代码：简单演示" class="headerlink" title="c. 示例代码：简单演示"></a>c. 示例代码：简单演示</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView

<span class="token keyword">class</span> <span class="token class-name">MyApiView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 原始数据</span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'Hello, World!'</span><span class="token punctuation">,</span>
            <span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'success'</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment"># 返回响应</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>data<span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在上面的例子中：</p>
<ul>
<li><strong><code>.data</code></strong> 是 <code>&#123;&#39;message&#39;: &#39;Hello, World!&#39;, &#39;status&#39;: &#39;success&#39;&#125;</code>，即传入的原始数据。</li>
<li><strong><code>.status_code</code></strong> 是 <code>200</code>，表示成功。</li>
<li><strong><code>.content</code></strong> 是 <code>&#123;&quot;message&quot;:&quot;Hello, World!&quot;,&quot;status&quot;:&quot;success&quot;&#125;</code>，即渲染器将数据转换为 JSON 格式的字符串。</li>
</ul>
<p>只需要传入 Python 的原始数据，框架会根据前端的需求和配置自动完成数据格式的转换和响应构造，大大简化了开发流程。</p>
<blockquote>
<p>DRF 的 <code>CBV</code> 将 HTTP 请求方法（GET、POST、PUT、DELETE 等）映射到类中同名的方法：</p>
<table>
<thead>
<tr>
<th>HTTP 方法</th>
<th>类方法名称</th>
<th>典型用途</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td><code>get()</code></td>
<td>查询单个资源或列表</td>
</tr>
<tr>
<td>POST</td>
<td><code>post()</code></td>
<td>创建新资源</td>
</tr>
<tr>
<td>PUT</td>
<td><code>put()</code></td>
<td>完整更新资源（需提供全部字段）</td>
</tr>
<tr>
<td>PATCH</td>
<td><code>patch()</code></td>
<td>部分更新资源（仅提供需修改的字段）</td>
</tr>
<tr>
<td>DELETE</td>
<td><code>delete()</code></td>
<td>删除资源</td>
</tr>
<tr>
<td>OPTIONS</td>
<td><code>options()</code></td>
<td>返回 API 元信息（自动生成）</td>
</tr>
<tr>
<td>HEAD</td>
<td><code>head()</code></td>
<td>返回资源头部信息（自动生成）</td>
</tr>
</tbody></table>
<p>这种映射机制由 DRF 的 <code>APIView</code> 基类实现，通过 <code>dispatch()</code> 方法根据请求类型调用对应的处理函数。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/zh-hans/5.2/ref/class-based-views/base/#">基础视图View类| Django documentation | Django</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/zh-hans/5.2/ref/class-based-views/">内置基于类的视图 API | Django documentation | Django</a></li>
<li><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/views/">视图APIView类 - Django REST 框架</a></li>
</ul>
</blockquote>
<h3 id="1-6-DRF-的-URL-路由方式"><a href="#1-6-DRF-的-URL-路由方式" class="headerlink" title="1.6 DRF 的 URL 路由方式"></a>1.6 DRF 的 URL 路由方式</h3><p>DRF 提供了多种路由方式，从低级到高级依次为：</p>
<h4 id="a-手动配置（适合简单-API）"><a href="#a-手动配置（适合简单-API）" class="headerlink" title="a. 手动配置（适合简单 API）"></a><strong>a. 手动配置（适合简单 API）</strong></h4><p>直接使用 <code>path()</code> 或 <code>re_path()</code> 映射到 DRF 的视图类：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView

<span class="token keyword">class</span> <span class="token class-name">ArticleList</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"文章列表"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ArticleDetail</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"文章 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>pk<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

<span class="token comment"># urls.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> ArticleList<span class="token punctuation">,</span> ArticleDetail

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/'</span><span class="token punctuation">,</span> ArticleList<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'article-list'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:pk>/'</span><span class="token punctuation">,</span> ArticleDetail<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'article-detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="b-使用-generics-通用视图"><a href="#b-使用-generics-通用视图" class="headerlink" title="b. 使用 generics 通用视图"></a>b. 使用 <code>generics</code> 通用视图</h4><p>DRF 的 <code>generics</code> 模块提供了预定义的视图类（如 <code>ListAPIView</code>、<code>RetrieveAPIView</code>）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Article
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ArticleSerializer

<span class="token keyword">class</span> <span class="token class-name">ArticleList</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>ListCreateAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer

<span class="token keyword">class</span> <span class="token class-name">ArticleDetail</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>RetrieveUpdateDestroyAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer

<span class="token comment"># urls.py</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/'</span><span class="token punctuation">,</span> ArticleList<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'article-list'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:pk>/'</span><span class="token punctuation">,</span> ArticleDetail<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'article-detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="c-使用-ViewSet-和-Router"><a href="#c-使用-ViewSet-和-Router" class="headerlink" title="c. 使用 ViewSet 和 Router"></a>c. 使用 ViewSet 和 Router</h4><p>DRF 的 <code>ViewSet</code> 和 <code>Router</code> 可以自动生成 URL 映射：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> Article
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ArticleSerializer

<span class="token keyword">class</span> <span class="token class-name">ArticleViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer

<span class="token comment"># urls.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter

router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'article'</span><span class="token punctuation">,</span> ArticleViewSet<span class="token punctuation">)</span>  <span class="token comment"># 自动生成 URL 映射</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 包含自动生成的 URL</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>自动生成的 URL 示例</strong>：</p>
<pre class="line-numbers language-none"><code class="language-none">GET &#x2F;article&#x2F;        → ArticleViewSet.list()
POST &#x2F;article&#x2F;       → ArticleViewSet.create()
GET &#x2F;article&#x2F;1&#x2F;      → ArticleViewSet.retrieve()
PUT &#x2F;article&#x2F;1&#x2F;      → ArticleViewSet.update()
DELETE &#x2F;article&#x2F;1&#x2F;   → ArticleViewSet.destroy()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-7-DRF封装的状态编码"><a href="#1-7-DRF封装的状态编码" class="headerlink" title="1.7 DRF封装的状态编码"></a>1.7 DRF封装的状态编码</h3><p>在DRF框架中，为了更方便地设置 HTTP 状态码，框架在 <code>rest_framework.status</code> 模块中定义了一系列常用的状态码常量。这些常量是标准的 HTTP 状态码表示，使用这些常量可以让代码更加清晰易读，也有助于减少拼写错误。</p>
<p>HTTP 状态码根据用途分为 5 大类：</p>
<table>
<thead>
<tr>
<th><strong>类别</strong></th>
<th>状态码范围</th>
<th>含义</th>
<th>典型场景示例</th>
</tr>
</thead>
<tbody><tr>
<td><strong>1xx 信息性状态码</strong></td>
<td>100-199</td>
<td>请求已接收，继续处理</td>
<td>100 Continue（客户端继续发送请求）</td>
</tr>
<tr>
<td><strong>2xx 成功状态码</strong></td>
<td>200-299</td>
<td>请求成功处理</td>
<td>200 OK（查询成功）、201 Created（资源创建）</td>
</tr>
<tr>
<td><strong>3xx 重定向状态码</strong></td>
<td>300-399</td>
<td>请求需要进一步操作</td>
<td>301 Moved Permanently（永久重定向）</td>
</tr>
<tr>
<td><strong>4xx 客户端错误状态码</strong></td>
<td>400-499</td>
<td>客户端请求有误</td>
<td>400 Bad Request（参数错误）、401 Unauthorized（未认证）</td>
</tr>
<tr>
<td><strong>5xx 服务器错误状态码</strong></td>
<td>500-599</td>
<td>服务器处理请求时出错</td>
<td>500 Internal Server Error（服务器内部错误）</td>
</tr>
</tbody></table>
<p>DRF中对于请求码常量的变量名格式定义遵循<code>HTTP_状态码_英文</code>描述规则:</p>
<table>
<thead>
<tr>
<th><strong>DRF 常量</strong></th>
<th>状态码</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>HTTP_200_OK</code></td>
<td>200</td>
<td>查询资源成功（如 GET 请求返回数据）</td>
</tr>
<tr>
<td><code>HTTP_201_CREATED</code></td>
<td>201</td>
<td>创建资源成功（如 POST 请求创建新数据）</td>
</tr>
<tr>
<td><code>HTTP_204_NO_CONTENT</code></td>
<td>204</td>
<td>操作成功但无返回内容（如 DELETE 请求删除资源后）</td>
</tr>
<tr>
<td><code>HTTP_400_BAD_REQUEST</code></td>
<td>400</td>
<td>客户端请求参数错误（如 JSON 格式错误、必填字段缺失）</td>
</tr>
<tr>
<td><code>HTTP_401_UNAUTHORIZED</code></td>
<td>401</td>
<td>用户未认证（如 Token 过期、未提供认证信息）</td>
</tr>
<tr>
<td><code>HTTP_403_FORBIDDEN</code></td>
<td>403</td>
<td>用户认证通过但无权限（如角色权限不足）</td>
</tr>
<tr>
<td><code>HTTP_404_NOT_FOUND</code></td>
<td>404</td>
<td>资源不存在（如访问不存在的 URL 或 ID）</td>
</tr>
<tr>
<td><code>HTTP_500_INTERNAL_SERVER_ERROR</code></td>
<td>500</td>
<td>服务器内部错误（如代码异常、数据库连接失败）</td>
</tr>
</tbody></table>
<p>注意：状态码的使用可以通过在Response对象的status参数中设置</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView

<span class="token keyword">class</span> <span class="token class-name">UserView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"data"</span><span class="token punctuation">:</span> user<span class="token punctuation">.</span>data<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_200_OK<span class="token punctuation">)</span>
        <span class="token keyword">except</span> User<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token string">"用户不存在"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 创建成功返回201，且返回新资源的URL</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span>
                serializer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_201_CREATED<span class="token punctuation">,</span>
                headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"Location"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"/users/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">&#125;</span>
            <span class="token punctuation">)</span>
        <span class="token comment"># 校验失败返回400，错误信息包含具体字段问题</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>
            serializer<span class="token punctuation">.</span>errors<span class="token punctuation">,</span>
            status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_400_BAD_REQUEST
        <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>更加具体的可以看django rest framwork的详细文档<a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/status-codes/#status-codes">Status codes - Django REST framework</a></p>
<h3 id="1-8-更高级的视图基类"><a href="#1-8-更高级的视图基类" class="headerlink" title="1.8 更高级的视图基类"></a>1.8 更高级的视图基类</h3><p>在 <code>Django REST framework</code> 中，视图是处理 HTTP 请求并返回响应的核心组件。REST framework 提供了很多类和方法来简化视图的编写，下面将详细介绍几种常见的视图基类和扩展类，并配上通俗易懂的代码示例。</p>
<h4 id="a-APIView"><a href="#a-APIView" class="headerlink" title="a. APIView"></a><strong>a. APIView</strong></h4><p><code>APIView</code> 是 Django REST framework 提供的所有视图的基类，继承自 Django 的 <code>View</code> 类。</p>
<p><strong>与 Django 的普通 <code>View</code> 的区别：</strong></p>
<ul>
<li>在 <code>APIView</code> 中，传入视图方法的请求对象是 REST framework 的 <code>Request</code> 对象，而不是 Django 的 <code>HttpRequest</code> 对象。</li>
<li>视图方法可以返回 <code>Response</code> 对象，响应的数据会自动根据前端的需求进行格式化（例如 JSON 格式）。</li>
<li>如果发生 <code>APIException</code> 异常，它会被自动捕获并转换为合适的响应信息。</li>
<li>在调用 <code>dispatch()</code> 方法前，框架会自动进行身份认证、权限检查和流量控制等操作。</li>
</ul>
<p><strong>常用属性：</strong></p>
<ul>
<li><code>authentication_classes</code>：指定身份认证类。</li>
<li><code>permission_classes</code>：指定权限控制类。</li>
<li><code>throttle_classes</code>：指定流量控制类。</li>
</ul>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookListView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取所有书籍数据</span>
        books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> BookInfoSerializer<span class="token punctuation">(</span>books<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个例子中，<code>BookListView</code> 继承自 <code>APIView</code>，并通过 <code>get()</code> 方法返回书籍列表。</p>
<h4 id="b-GenericAPIView"><a href="#b-GenericAPIView" class="headerlink" title="b. GenericAPIView"></a><strong>b. GenericAPIView</strong></h4><p><code>GenericAPIView</code> 继承自 <code>APIView</code>，增加了对列表视图和详情视图常用方法的支持，通常与 <code>Mixin</code> 类一起使用。</p>
<p><strong>常用属性：</strong></p>
<ul>
<li><code>queryset</code>：列表视图查询的数据集。</li>
<li><code>serializer_class</code>：使用的序列化器类。</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><code>get_queryset()</code>：获取查询集的方法。</li>
<li><code>get_serializer_class()</code>：获取序列化器类的方法。</li>
</ul>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>generics <span class="token keyword">import</span> GenericAPIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookDetailView</span><span class="token punctuation">(</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取单本书籍数据</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取单一数据对象</span>
        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>book<span class="token punctuation">)</span>  <span class="token comment"># 序列化数据</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里的 <code>BookDetailView</code> 继承自 <code>GenericAPIView</code>，通过 <code>get()</code> 方法返回某本书籍的详细信息。</p>
<h3 id="1-9-拓展视图类的功能-多重继承"><a href="#1-9-拓展视图类的功能-多重继承" class="headerlink" title="1.9 拓展视图类的功能(多重继承)"></a>1.9 拓展视图类的功能(多重继承)</h3><p>扩展类（Mixin）是为了简化常见的操作（如创建、更新、删除等），它们可以与 <code>GenericAPIView</code> 一起使用，提供快速实现常见视图功能的方法。</p>
<p><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/generic-views/#listmodelmixin">视图拓展 - Django REST 框架</a></p>
<h4 id="a-ListModelMixin"><a href="#a-ListModelMixin" class="headerlink" title="a. ListModelMixin"></a><strong>a. ListModelMixin</strong></h4><p>用于快速实现列表视图的功能。提供 <code>list()</code> 方法，返回符合过滤和分页条件的列表。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookListView</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>ListModelMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># list方法中将queryset的函数序列化之后返回</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>  <span class="token comment"># 使用 ListModelMixin 中的 list 方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="b-CreateModelMixin"><a href="#b-CreateModelMixin" class="headerlink" title="b. CreateModelMixin"></a><strong>b. CreateModelMixin</strong></h4><p>用于创建资源的视图。提供 <code>create()</code> 方法，成功时返回 201 状态码。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookCreateView</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>CreateModelMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>create<span class="token punctuation">(</span>request<span class="token punctuation">)</span>  <span class="token comment"># 使用 CreateModelMixin 中的 create 方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="c-RetrieveModelMixin"><a href="#c-RetrieveModelMixin" class="headerlink" title="c. RetrieveModelMixin"></a><strong>c. RetrieveModelMixin</strong></h4><p>用于返回单个对象的详情视图。提供 <code>retrieve()</code> 方法。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookDetailView</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>RetrieveModelMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>retrieve<span class="token punctuation">(</span>request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span>  <span class="token comment"># 使用 RetrieveModelMixin 中的 retrieve 方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="d-UpdateModelMixin"><a href="#d-UpdateModelMixin" class="headerlink" title="d. UpdateModelMixin"></a><strong>d. UpdateModelMixin</strong></h4><p>用于更新资源的视图。提供 <code>update()</code> 和 <code>partial_update()</code> 方法。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookUpdateView</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>UpdateModelMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>update<span class="token punctuation">(</span>request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span>  <span class="token comment"># 使用 UpdateModelMixin 中的 update 方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="e-DestroyModelMixin"><a href="#e-DestroyModelMixin" class="headerlink" title="e. DestroyModelMixin"></a><strong>e. DestroyModelMixin</strong></h4><p>用于删除资源的视图。提供 <code>destroy()</code> 方法，成功时返回 204 状态码。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> BookInfo
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> BookInfoSerializer

<span class="token keyword">class</span> <span class="token class-name">BookDeleteView</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>DestroyModelMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>GenericAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span>request<span class="token punctuation">,</span> pk<span class="token punctuation">)</span>  <span class="token comment"># 使用 DestroyModelMixin 中的 destroy 方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-10-ViewSet视图集"><a href="#1-10-ViewSet视图集" class="headerlink" title="1.10 ViewSet视图集"></a>1.10 ViewSet视图集</h3><p><strong>视图集（ViewSet）</strong> 是一个用来处理一组相关动作（如列出数据、创建数据、更新数据等）的大类。通过视图集，你可以将这些逻辑放在一个类里，而不需要分别为每个动作编写单独的视图函数。</p>
<h4 id="常见的ViewSet动作"><a href="#常见的ViewSet动作" class="headerlink" title="常见的ViewSet动作"></a><strong>常见的ViewSet动作</strong></h4><ul>
<li><code>list()</code>：提供一组数据（如获取所有书籍）。</li>
<li><code>retrieve()</code>：提供单个数据（如获取某本书的详细信息）。</li>
<li><code>create()</code>：创建新数据（如添加一本新书）。</li>
<li><code>update()</code>：更新数据（如修改一本书的信息）。</li>
<li><code>destroy()</code>：删除数据（如删除一本书）。</li>
</ul>
<p>在 <code>ViewSet</code> 中，不需要显式地定义<code>APIView</code>类的<code>get()</code>、<code>post()</code> 等方法，而是定义这些动作的方法（<code>list()</code>、<code>create()</code> 等）。当你调用 <code>as_view()</code> 时，框架会自动将请求与具体的动作方法（action）对应起来。</p>
<p><strong>示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">BookInfoViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 返回所有书籍</span>
        books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'books'</span><span class="token punctuation">:</span> books<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 返回单本书籍详情</span>
        book <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'book'</span><span class="token punctuation">:</span> book<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当我们定义了这样的 <code>BookInfoViewSet</code> 类后，路由的配置会将 HTTP 请求与相应的动作方法（如 <code>list()</code>、<code>retrieve()</code>）关联起来：</p>
<h4 id="设置路由"><a href="#设置路由" class="headerlink" title="设置路由"></a><strong>设置路由</strong></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> BookInfoViewSet

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 注意 as_view()函数的参数，字典的键就是对应的HTTP请求的方法类型，而对应的值就是要调用的视图集中的对应方法    path('books/', BookInfoViewSet.as_view(&#123;'get': 'list'&#125;)),  # 获取书籍列表</span>
    path<span class="token punctuation">(</span><span class="token string">'books/&lt;int:pk>/'</span><span class="token punctuation">,</span> BookInfoViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'retrieve'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 获取单本书籍</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="action属性"><a href="#action属性" class="headerlink" title="action属性"></a><strong>action属性</strong></h4><p>在视图集中，<code>action</code> 属性可以帮助你判断当前请求执行的是哪个动作方法。例如，你可以根据 <code>action</code> 来决定使用哪个序列化器：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_serializer_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>action <span class="token operator">==</span> <span class="token string">'create'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> BookCreateSerializer
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> BookListSerializer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个例子中，如果 <code>action</code> 是 <code>create</code>，则使用 <code>BookCreateSerializer</code>，否则使用 <code>BookListSerializer</code>。</p>
<h4 id="常用视图集父类"><a href="#常用视图集父类" class="headerlink" title="常用视图集父类"></a><strong>常用视图集父类</strong></h4><ul>
<li><strong>ViewSet</strong></li>
</ul>
<p><code>ViewSet</code> 是最基本的视图集类，它继承自 <code>APIView</code>。使用时需要自己定义具体的动作方法（如 <code>list()</code>、<code>create()</code> 等）。</p>
<ul>
<li><strong>GenericViewSet</strong></li>
</ul>
<p><code>GenericViewSet</code> 继承自 <code>GenericAPIView</code>，提供了常用的功能方法（如 <code>get_queryset()</code> 和 <code>get_serializer_class()</code>），简化了视图集的开发，特别适合用于列表视图和详情视图。</p>
<ul>
<li><strong>ModelViewSet</strong></li>
</ul>
<p><code>ModelViewSet</code> 继承自 <code>GenericViewSet</code>，并且包含了 <code>ListModelMixin</code>、<code>RetrieveModelMixin</code>、<code>CreateModelMixin</code>、<code>UpdateModelMixin</code>、<code>DestroyModelMixin</code>，因此它提供了对模型的增删改查（CRUD）操作，简化了视图集的实现。</p>
<ul>
<li><strong>ReadOnlyModelViewSet</strong></li>
</ul>
<p><code>ReadOnlyModelViewSet</code> 继承自 <code>GenericViewSet</code>，并包含了 <code>ListModelMixin</code> 和 <code>RetrieveModelMixin</code>，适用于只需要读取数据的视图集。</p>
<h4 id="定义附加自定义动作"><a href="#定义附加自定义动作" class="headerlink" title="定义附加自定义动作"></a><strong>定义附加自定义动作</strong></h4><p>除了框架默认的动作（如 <code>list()</code>、<code>retrieve()</code>），你还可以在视图集中定义自定义的动作（action）。这些自定义动作通过 <code>@action</code> 装饰器来实现。</p>
<p><strong>自定义动作</strong></p>
<ul>
<li><code>methods</code>：指定此动作支持的 HTTP 请求方法（如 <code>GET</code>、<code>POST</code>）。</li>
<li><code>detail</code>：指定动作是否是针对某个单独的对象（<code>True</code> 表示针对某个对象，<code>False</code> 表示不针对对象）。</li>
</ul>
<p><strong>代码示例：</strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">BookInfoViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>GenericViewSet<span class="token punctuation">,</span> mixins<span class="token punctuation">.</span>ListModelMixin<span class="token punctuation">,</span> mixins<span class="token punctuation">.</span>RetrieveModelMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> BookInfoSerializer

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">latest</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 返回最新添加的书籍</span>
        latest_books <span class="token operator">=</span> BookInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'-created_at'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'latest_books'</span><span class="token punctuation">:</span> latest_books<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'put'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 标记某本书为已读</span>
        book <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        book<span class="token punctuation">.</span>read <span class="token operator">=</span> <span class="token boolean">True</span>
        book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'book'</span><span class="token punctuation">:</span> BookInfoSerializer<span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个视图集类将会有两个自定义的动作：</p>
<ul>
<li><code>latest</code>：返回最新的 5 本书。</li>
<li><code>read</code>：更新某本书的状态为已读。</li>
</ul>
<p><strong>形成的路由：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">正则^books&#x2F;latest&#x2F;$  name: book-latest
正则^books&#x2F;&#123;pk&#125;&#x2F;read&#x2F;$  name: book-read<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="自定义动作的路由参数"><a href="#自定义动作的路由参数" class="headerlink" title="自定义动作的路由参数"></a>自定义动作的路由参数</h4><p>在 DRF 的 ViewSet 中，自定义动作（使用 <code>@action</code> 装饰器）添加参数主要通过 <strong>URL 路径参数</strong>、<strong>查询参数</strong> 和 <strong>请求体参数</strong> 三种方式实现。以下是详细的实现方法和示例：</p>
<ol>
<li><strong>通过 URL 路径参数传递（路径变量）</strong></li>
</ol>
<p>使用 <code>detail=True</code> 或 <code>detail=False</code> 参数，并在 URL 路径中定义变量。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> url_path<span class="token operator">=</span><span class="token string">r'send-email/(?P&lt;email_type>\w+)'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">send_email</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> email_type<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        发送指定类型的邮件给用户
        URL 示例：/users/123/send-email/activation/
        """</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 根据 email_type 参数执行不同逻辑</span>
        <span class="token keyword">if</span> email_type <span class="token operator">==</span> <span class="token string">'activation'</span><span class="token punctuation">:</span>
            send_activation_email<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> email_type <span class="token operator">==</span> <span class="token string">'reset'</span><span class="token punctuation">:</span>
            send_reset_email<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>email_type<span class="token punctuation">&#125;</span></span><span class="token string"> email sent'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>关键参数说明</p>
<ul>
<li><code>detail=True</code>：表示该动作作用于单个对象，URL 中必须包含对象 ID（如 <code>/users/&#123;id&#125;/action/</code>）。</li>
<li><code>url_path</code>：自定义 URL 路径，使用正则表达式捕获参数（如 <code>(?P&lt;email_type&gt;\w+)</code>）。</li>
</ul>
<ol start="2">
<li><strong>通过查询参数传递（GET 参数）</strong></li>
</ol>
<p>直接从 <code>request.query_params</code> 中获取参数，无需额外配置。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    根据关键词搜索用户
    URL 示例：/users/search/?keyword=john&amp;age=25
    """</span>
    keyword <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'keyword'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span>
    
    queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> keyword<span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> queryset<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username__icontains<span class="token operator">=</span>keyword<span class="token punctuation">)</span>
    <span class="token keyword">if</span> age<span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> queryset<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>age<span class="token operator">=</span>age<span class="token punctuation">)</span>
    
    serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>参数校验建议</strong></p>
<p>使用 DRF 的序列化器校验查询参数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">SearchSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    keyword <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> min_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    serializer <span class="token operator">=</span> SearchSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>query_params<span class="token punctuation">)</span>
    serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 使用校验后的数据</span>
    keyword <span class="token operator">=</span> serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'keyword'</span><span class="token punctuation">)</span>
    <span class="token comment"># ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><strong>通过请求体参数传递（POST&#x2F;PUT&#x2F;PATCH）</strong></li>
</ol>
<p>从 <code>request.data</code> 中获取参数，建议使用序列化器校验。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ResetPasswordSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    old_password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    new_password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> min_length<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">reset_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    重置用户密码
    请求体示例：&#123;"old_password": "123456", "new_password": "new123456"&#125;
    """</span>
    user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer <span class="token operator">=</span> ResetPasswordSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span>raise_exception<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 验证旧密码</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> user<span class="token punctuation">.</span>check_password<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">[</span><span class="token string">'old_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'旧密码错误'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 设置新密码</span>
    user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">[</span><span class="token string">'new_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'密码已重置'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>综合的案例</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> url_path<span class="token operator">=</span><span class="token string">r'add-role/(?P&lt;role_name>\w+)'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add_role</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> role_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    为用户添加指定角色
    URL 示例：/users/123/add-role/admin/
    请求体示例：&#123;"expires_at": "2023-12-31"&#125;
    """</span>
    user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
    expires_at <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'expires_at'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 添加角色逻辑</span>
    user<span class="token punctuation">.</span>roles<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token operator">=</span>role_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> expires_at<span class="token punctuation">:</span>
        user<span class="token punctuation">.</span>role_expires <span class="token operator">=</span> expires_at
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'已添加角色 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>role_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="参数校验与错误处理"><a href="#参数校验与错误处理" class="headerlink" title="参数校验与错误处理"></a>参数校验与错误处理</h4><ol>
<li><p><strong>使用序列化器校验</strong><br> 对复杂参数（如请求体），始终使用 DRF 序列化器进行校验，自动处理错误返回。</p>
</li>
<li><p><strong>处理必填参数</strong><br> 在序列化器中设置 <code>required=True</code>，或在代码中显式检查：</p>
 <pre class="line-numbers language-python" data-language="python"><code class="language-python">keyword <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'keyword'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> keyword<span class="token punctuation">:</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'keyword 参数是必需的'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>自定义错误信息</strong><br> 通过 <code>error_messages</code> 参数定制错误提示：</p>
 <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">SearchSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    keyword <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>
        required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        error_messages<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'required'</span><span class="token punctuation">:</span> <span class="token string">'请提供搜索关键词'</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="1-11-Router类"><a href="#1-11-Router类" class="headerlink" title="1.11 Router类"></a>1.11 Router类</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dream-ze/p/17593148.html">【9.0】DRF之路由 - Chimengmeng - 博客园</a></p>
<h4 id="1-两种主要路由类型"><a href="#1-两种主要路由类型" class="headerlink" title="1. 两种主要路由类型"></a><strong>1. 两种主要路由类型</strong></h4><table>
<thead>
<tr>
<th>路由类型</th>
<th>特点</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><code>SimpleRouter</code></td>
<td>生成基础的 RESTful URL，如 <code>/users/</code> 和 <code>/users/&#123;id&#125;/</code></td>
<td>标准资源 CRUD 操作</td>
</tr>
<tr>
<td><code>DefaultRouter</code></td>
<td>继承自 <code>SimpleRouter</code>，额外生成 API 根视图（带超链接）和可选格式后缀</td>
<td>需要自动生成 API 文档或超链接</td>
</tr>
</tbody></table>
<h4 id="2-路由绑定的核心逻辑"><a href="#2-路由绑定的核心逻辑" class="headerlink" title="2. 路由绑定的核心逻辑"></a>2. <strong>路由绑定的核心逻辑</strong></h4><ul>
<li>**视图集 (ViewSet)**：DRF 特有的视图类型，将相关操作（如 <code>list</code>、<code>create</code>、<code>retrieve</code>）组合到一个类中。</li>
<li><strong>路由自动映射</strong>：通过 <code>router.register()</code> 方法将视图集与 URL 前缀绑定，自动生成对应 URL 模式。</li>
</ul>
<h4 id="a-使用-DefaultRouter-配置标准视图集"><a href="#a-使用-DefaultRouter-配置标准视图集" class="headerlink" title="a. 使用 DefaultRouter 配置标准视图集"></a>a. <strong>使用 <code>DefaultRouter</code> 配置标准视图集</strong></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># urls.py</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> routers
<span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> UserViewSet<span class="token punctuation">,</span> GroupViewSet

<span class="token comment"># 创建路由器并注册视图集</span>
router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">)</span>  <span class="token comment"># 自动生成 /users/ 和 /users/&#123;id&#125;/</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'groups'</span><span class="token punctuation">,</span> GroupViewSet<span class="token punctuation">)</span>

<span class="token comment"># 将生成的 URL 配置添加到 urlpatterns</span>
urlpatterns <span class="token operator">=</span> router<span class="token punctuation">.</span>urls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="b-对应的视图集定义"><a href="#b-对应的视图集定义" class="headerlink" title="b. 对应的视图集定义"></a>b. <strong>对应的视图集定义</strong></h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> User<span class="token punctuation">,</span> Group
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> UserSerializer<span class="token punctuation">,</span> GroupSerializer

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    自动提供 list、create、retrieve、update 和 destroy 操作
    """</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

<span class="token keyword">class</span> <span class="token class-name">GroupViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Group<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> GroupSerializer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="c-自动生成的URL模式"><a href="#c-自动生成的URL模式" class="headerlink" title="c. 自动生成的URL模式"></a>c. <strong>自动生成的URL模式</strong></h4><table>
<thead>
<tr>
<th>HTTP 方法</th>
<th>URL 路径</th>
<th>对应的视图方法</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td><code>/users/</code></td>
<td><code>list()</code></td>
<td>获取用户列表</td>
</tr>
<tr>
<td>POST</td>
<td><code>/users/</code></td>
<td><code>create()</code></td>
<td>创建新用户</td>
</tr>
<tr>
<td>GET</td>
<td><code>/users/&#123;id&#125;/</code></td>
<td><code>retrieve()</code></td>
<td>获取单个用户详情</td>
</tr>
<tr>
<td>PUT</td>
<td><code>/users/&#123;id&#125;/</code></td>
<td><code>update()</code></td>
<td>完整更新用户信息</td>
</tr>
<tr>
<td>PATCH</td>
<td><code>/users/&#123;id&#125;/</code></td>
<td><code>partial_update()</code></td>
<td>部分更新用户信息</td>
</tr>
<tr>
<td>DELETE</td>
<td><code>/users/&#123;id&#125;/</code></td>
<td><code>destroy()</code></td>
<td>删除用户</td>
</tr>
</tbody></table>
<p>使用 <code>@action</code> 装饰器为视图集添加自定义操作：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># detail=True 表示针对单个对象</span>
    <span class="token keyword">def</span> <span class="token function">reset_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 重置密码逻辑</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'password reset'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>生成的 URL：<code>/users/&#123;id&#125;/reset_password/</code>  POST方法请求就会调用对应函数里的逻辑</p>
<h3 id="1-12-APIView和ViewSet的选择"><a href="#1-12-APIView和ViewSet的选择" class="headerlink" title="1.12 APIView和ViewSet的选择"></a>1.12 APIView和ViewSet的选择</h3><p>在 Django REST Framework (DRF) 中，<code>APIView</code> 和 <code>ViewSet</code> 是构建 API 视图的两种核心方式，它们的设计目标和适用场景不同。以下从<strong>功能对比、适用场景、实战建议</strong>三方面详细解析：</p>
<h4 id="a-核心区别：从设计目标理解"><a href="#a-核心区别：从设计目标理解" class="headerlink" title="a. 核心区别：从设计目标理解"></a>a. 核心区别：从设计目标理解</h4><table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>APIView</strong></th>
<th><strong>ViewSet</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>设计理念</strong></td>
<td>专注于 HTTP 方法（GET&#x2F;POST&#x2F;PUT&#x2F;DELETE）</td>
<td>专注于资源操作（List&#x2F;Create&#x2F;Retrieve&#x2F;Update）</td>
</tr>
<tr>
<td><strong>URL 定义方式</strong></td>
<td>手动在 <code>urls.py</code> 中定义每个 URL 路径</td>
<td>通过路由（Router）自动生成 URL 模式</td>
</tr>
<tr>
<td><strong>代码复用性</strong></td>
<td>低，需手动实现每个 HTTP 方法</td>
<td>高，继承通用操作（如 <code>ModelViewSet</code>）</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>自定义逻辑复杂的接口</td>
<td>标准 CRUD 操作或资源管理</td>
</tr>
</tbody></table>
<h4 id="b-适用场景对比"><a href="#b-适用场景对比" class="headerlink" title="b. 适用场景对比"></a>b. 适用场景对比</h4><ol>
<li><strong>使用 <code>APIView</code> 的场景</strong></li>
</ol>
<ul>
<li><strong>需要完全自定义请求处理逻辑</strong><br>  当接口逻辑复杂，无法通过通用操作实现时，使用 <code>APIView</code> 更灵活。<br>  <strong>示例</strong>：多表联合查询、复杂权限校验、第三方 API 集成。</li>
<li><strong>处理非标准 RESTful 请求</strong><br>  当接口不遵循标准的 CRUD 模式时（如批量操作、状态机转换）。<br>  <strong>示例</strong>：一次性创建多个资源、触发特定业务流程。</li>
<li><strong>需要精细控制请求 &#x2F; 响应流程</strong><br>  当需要自定义序列化、认证或异常处理逻辑时。<br>  <strong>示例</strong>：处理文件上传、实现自定义限流策略。</li>
</ul>
<ol start="2">
<li><strong>使用 <code>ViewSet</code> 的场景</strong></li>
</ol>
<ul>
<li><strong>标准 RESTful 资源管理</strong><br>  当接口需要实现完整的 CRUD 操作时，使用 <code>ViewSet</code> 可大幅减少代码量。<br>  <strong>示例</strong>：用户管理、工单系统、配置项管理。</li>
<li><strong>快速构建 API</strong><br>  当需要快速搭建原型或接口遵循标准模式时，利用路由自动生成 URL。<br>  <strong>示例</strong>：基于模型的简单增删改查接口。</li>
<li><strong>资源关系明确的场景</strong><br>  当资源间存在嵌套关系（如 <code>/projects/&#123;id&#125;/tasks/</code>），可结合嵌套路由使用。<br>  <strong>示例</strong>：项目 - 任务、组织 - 用户等层级关系。</li>
</ul>
<h4 id="c-实战案例对比"><a href="#c-实战案例对比" class="headerlink" title="c. 实战案例对比"></a>c. 实战案例对比</h4><ol>
<li><strong>APIView 示例：复杂业务逻辑接口</strong></li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db<span class="token punctuation">.</span>models <span class="token keyword">import</span> Q

<span class="token keyword">class</span> <span class="token class-name">SearchUsersAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    复杂搜索接口：支持多条件筛选、分页和排序
    """</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 解析查询参数</span>
        query <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        min_age <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'min_age'</span><span class="token punctuation">)</span>
        max_age <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'max_age'</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 构建复杂查询</span>
        users <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> query<span class="token punctuation">:</span>
            users <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>
                Q<span class="token punctuation">(</span>username__icontains<span class="token operator">=</span>query<span class="token punctuation">)</span> <span class="token operator">|</span> 
                Q<span class="token punctuation">(</span>email__icontains<span class="token operator">=</span>query<span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token keyword">if</span> min_age<span class="token punctuation">:</span>
            users <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>age__gte<span class="token operator">=</span>min_age<span class="token punctuation">)</span>
        <span class="token keyword">if</span> max_age<span class="token punctuation">:</span>
            users <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>age__lte<span class="token operator">=</span>max_age<span class="token punctuation">)</span>
        
        <span class="token comment"># 自定义分页和序列化</span>
        serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><strong>ViewSet 示例：标准用户管理接口</strong></li>
</ol>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># views.py</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> <span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> <span class="token punctuation">.</span>serializers <span class="token keyword">import</span> UserSerializer

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    自动提供 list、create、retrieve、update 和 destroy 操作
    """</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAuthenticated<span class="token punctuation">]</span>  <span class="token comment"># 统一权限控制</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># urls.py（自动生成路由）</span>
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> routers
<span class="token keyword">from</span> <span class="token punctuation">.</span>views <span class="token keyword">import</span> UserViewSet

router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> router<span class="token punctuation">.</span>urls<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="d-高级技巧：混合使用-APIView-和-ViewSet"><a href="#d-高级技巧：混合使用-APIView-和-ViewSet" class="headerlink" title="d. 高级技巧：混合使用 APIView 和 ViewSet"></a>d. 高级技巧：混合使用 APIView 和 ViewSet</h4><ol>
<li><strong>在 ViewSet 中自定义操作</strong></li>
</ol>
<p>使用 <code>@action</code> 装饰器为 ViewSet 添加自定义 APIView 风格的方法：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

    <span class="token decorator annotation punctuation">@action</span><span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 自定义 POST 操作</span>
    <span class="token keyword">def</span> <span class="token function">reset_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""重置用户密码（复杂业务逻辑）"""</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        old_password <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'old_password'</span><span class="token punctuation">)</span>
        new_password <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'new_password'</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 复杂密码验证逻辑</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> user<span class="token punctuation">.</span>check_password<span class="token punctuation">(</span>old_password<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'旧密码错误'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>new_password<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'密码长度不足'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
        
        user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>new_password<span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'密码已重置'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><strong>基于 APIView 构建基础视图，再封装为 ViewSet</strong></li>
</ol>
<p>当需要复用自定义 APIView 的逻辑时，可通过继承构建 ViewSet：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">CustomAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 自定义复杂逻辑</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">CustomViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> CustomAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="e-选择建议：从需求出发"><a href="#e-选择建议：从需求出发" class="headerlink" title="e. 选择建议：从需求出发"></a>e. 选择建议：从需求出发</h4><ol>
<li><strong>优先考虑 ViewSet</strong><br> 对于标准 RESTful 资源，直接使用 <code>ModelViewSet</code> 配合路由，可大幅提高开发效率。</li>
<li><strong>使用 APIView 处理特殊场景</strong><br> 当接口逻辑复杂、不遵循标准模式或需要精细控制时，使用 <code>APIView</code>。</li>
<li><strong>灵活组合两者</strong><br> 在同一项目中，可根据接口特性混合使用 <code>APIView</code> 和 <code>ViewSet</code>，甚至在 ViewSet 中嵌入自定义 APIView 逻辑。</li>
<li><strong>参考项目已有规范</strong><br> 在蓝鲸 DevOps 插件开发中，若团队已有成熟的 API 设计规范，优先遵循现有模式。</li>
</ol>
<h4 id="f-总结：设计权衡"><a href="#f-总结：设计权衡" class="headerlink" title="f. 总结：设计权衡"></a>f. 总结：设计权衡</h4><table>
<thead>
<tr>
<th><strong>场景</strong></th>
<th><strong>推荐选择</strong></th>
<th><strong>理由</strong></th>
</tr>
</thead>
<tbody><tr>
<td>标准 CRUD 接口</td>
<td>ViewSet</td>
<td>自动生成路由，代码量少，符合 RESTful 规范</td>
</tr>
<tr>
<td>复杂业务逻辑接口</td>
<td>APIView</td>
<td>完全控制请求处理流程，便于实现自定义逻辑</td>
</tr>
<tr>
<td>资源嵌套关系（如 &#x2F;parent&#x2F;{id}&#x2F;child&#x2F;）</td>
<td>ViewSet + 嵌套路由</td>
<td>简化嵌套资源的 URL 配置和处理逻辑</td>
</tr>
<tr>
<td>需要与第三方系统集成</td>
<td>APIView</td>
<td>灵活处理非标准请求 &#x2F; 响应格式，便于集成外部服务</td>
</tr>
<tr>
<td>快速原型开发</td>
<td>ViewSet</td>
<td>最短时间内搭建完整 API</td>
</tr>
</tbody></table>
<p>在实际开发中，建议根据接口的复杂度和复用性需求灵活选择。对于蓝鲸 DevOps 插件，大多数标准资源管理接口可使用 ViewSet，而涉及复杂业务流程的接口则适合用 APIView 实现。</p>
<h2 id="2-其他系统功能"><a href="#2-其他系统功能" class="headerlink" title="2. 其他系统功能"></a>2. 其他系统功能</h2><h3 id="2-1-权限Permissions"><a href="#2-1-权限Permissions" class="headerlink" title="2.1 权限Permissions"></a>2.1 权限Permissions</h3><p><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/permissions/#custom-permissions">权限 - Django REST 框架</a></p>
<h3 id="2-2-认证Authentication"><a href="#2-2-认证Authentication" class="headerlink" title="2.2 认证Authentication"></a>2.2 认证Authentication</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38628046/article/details/129867998">Django REST Framework（DRF）框架之认证Authentication与权限Permission</a></p>
<h3 id="2-3-其他新功能"><a href="#2-3-其他新功能" class="headerlink" title="2.3 其他新功能"></a>2.3 其他新功能</h3><p>请参考以下博客：</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.cn/developer/article/2462615">Django rest Framework入门 五 ：认证、权限、限流、分页和过滤-腾讯云开发者社区-腾讯云</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yuanfate/article/details/108669238">Django的DRF（三）：其他功能（认证、权限、限流、分页、过滤、排序、异常处理、接口文档）_django drf curd-CSDN博客</a></p>
<h2 id="3-致谢"><a href="#3-致谢" class="headerlink" title="3. 致谢"></a>3. 致谢</h2><p>再次感谢所有被引用内容的原作者，你们的分享为技术社区提供了宝贵的知识财富。如有标注疏漏，请随时联系笔者补充修正。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://0zxm.github.io">0zxm</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://0zxm.github.io/2025/06/25/framwork-kuang-jia-xue-xi/">https://0zxm.github.io/2025/06/25/framwork-kuang-jia-xue-xi/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://0zxm.github.io" target="_blank">0zxm</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/web%E6%A1%86%E6%9E%B6/">web框架</a></div><div class="post-share"><div class="social-share" data-image="/img/default_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/06/19/wide-deep-mo-xing/" title="Wide&amp;Deep模型"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Wide&Deep模型</div></div><div class="info-2"><div class="info-item-1">机器学习大作业实现过程的笔记</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/01/15/django-he-vue3-qian-hou-duan-fen-chi-kai-fa/" title="Django和Vue3前后端补充知识点"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-15</div><div class="info-item-2">Django和Vue3前后端补充知识点</div></div><div class="info-2"><div class="info-item-1">Django和Vue3前后端分离开发</div></div></div></a><a class="pagination-related" href="/2024/11/23/django-xue-xi/" title="Django学习"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-23</div><div class="info-item-2">Django学习</div></div><div class="info-2"><div class="info-item-1">Django框架的学习</div></div></div></a><a class="pagination-related" href="/2025/01/05/mindspore-shou-xie-shu-zi-shi-bie/" title="Mindspore手写数字识别"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-05</div><div class="info-item-2">Mindspore手写数字识别</div></div><div class="info-2"><div class="info-item-1">使用MindSpore深度学习框架，进行网络搭建、数据处理、网络训练和测试，完成MNIST手写体识别任务</div></div></div></a><a class="pagination-related" href="/2025/06/19/wide-deep-mo-xing/" title="Wide&amp;Deep模型"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-19</div><div class="info-item-2">Wide&amp;Deep模型</div></div><div class="info-2"><div class="info-item-1">机器学习大作业实现过程的笔记</div></div></div></a><a class="pagination-related" href="/2024/09/09/pyqt-kai-fa-yi-ge-ji-shi-ben/" title="pyqt开发一个记事本"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-09</div><div class="info-item-2">pyqt开发一个记事本</div></div><div class="info-2"><div class="info-item-1">构建一个功能丰富的记事本应用：深入 PyQt5</div></div></div></a><a class="pagination-related" href="/2025/02/15/pyqt-xie-yi-ge-dai-ban-cheng-xu/" title="pyqt写一个待办程序"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-15</div><div class="info-item-2">pyqt写一个待办程序</div></div><div class="info-2"><div class="info-item-1">构建一个功能丰富的待办应用：深入PyQt5</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">0zxm</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/0zxm"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/0zxm" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:m15813109801@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="http://0zxm.github.io" target="_blank" title="博客"><i class="fab fa-algolia" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89DRF"><span class="toc-text">0.为什么会有DRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">0.1 环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-2-API%E6%96%87%E6%A1%A3%E7%9A%84%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90"><span class="toc-text">0.2 API文档的自动生成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%94%B9%E8%BF%9B%E7%9A%84%E7%89%B9%E7%82%B9-%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E8%A7%86%E5%9B%BE"><span class="toc-text">1.改进的特点 - 序列化和视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">1.1 序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Serializer%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-text">1.2 Serializer序列化器的简单使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E5%88%9B%E5%BB%BA%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E5%AF%B9%E8%B1%A1"><span class="toc-text">a. 创建序列化器对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">b. 基本操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E5%85%B3%E8%81%94%E5%AF%B9%E8%B1%A1%E5%B5%8C%E5%A5%97%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">c.关联对象嵌套序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PrimaryKeyRelatedField-%E9%BB%98%E8%AE%A4%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E5%BC%8F"><span class="toc-text">PrimaryKeyRelatedField (默认的序列化方式)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">1.3 反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E9%AA%8C%E8%AF%81"><span class="toc-text">a.验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E4%BF%9D%E5%AD%98"><span class="toc-text">b.保存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E6%A8%A1%E5%9E%8B%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8"><span class="toc-text">1.4 模型序列化器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5-Meta%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">a. 指定字段-Meta类的属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E6%B7%BB%E5%8A%A0%E9%A2%9D%E5%A4%96%E5%8F%82%E6%95%B0"><span class="toc-text">b. 添加额外参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E6%95%B4%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-text">c. 整合示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E4%BC%98%E5%8C%96%E7%9A%84Request%E5%92%8CResponse%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.5 优化的Request和Response对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-Request%E5%AF%B9%E8%B1%A1"><span class="toc-text">a. Request对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-Response%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="toc-text">b. Response的对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A%E7%AE%80%E5%8D%95%E6%BC%94%E7%A4%BA"><span class="toc-text">c. 示例代码：简单演示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-DRF-%E7%9A%84-URL-%E8%B7%AF%E7%94%B1%E6%96%B9%E5%BC%8F"><span class="toc-text">1.6 DRF 的 URL 路由方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE%EF%BC%88%E9%80%82%E5%90%88%E7%AE%80%E5%8D%95-API%EF%BC%89"><span class="toc-text">a. 手动配置（适合简单 API）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E4%BD%BF%E7%94%A8-generics-%E9%80%9A%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="toc-text">b. 使用 generics 通用视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E4%BD%BF%E7%94%A8-ViewSet-%E5%92%8C-Router"><span class="toc-text">c. 使用 ViewSet 和 Router</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-DRF%E5%B0%81%E8%A3%85%E7%9A%84%E7%8A%B6%E6%80%81%E7%BC%96%E7%A0%81"><span class="toc-text">1.7 DRF封装的状态编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-%E6%9B%B4%E9%AB%98%E7%BA%A7%E7%9A%84%E8%A7%86%E5%9B%BE%E5%9F%BA%E7%B1%BB"><span class="toc-text">1.8 更高级的视图基类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-APIView"><span class="toc-text">a. APIView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-GenericAPIView"><span class="toc-text">b. GenericAPIView</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-9-%E6%8B%93%E5%B1%95%E8%A7%86%E5%9B%BE%E7%B1%BB%E7%9A%84%E5%8A%9F%E8%83%BD-%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF"><span class="toc-text">1.9 拓展视图类的功能(多重继承)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-ListModelMixin"><span class="toc-text">a. ListModelMixin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-CreateModelMixin"><span class="toc-text">b. CreateModelMixin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-RetrieveModelMixin"><span class="toc-text">c. RetrieveModelMixin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#d-UpdateModelMixin"><span class="toc-text">d. UpdateModelMixin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#e-DestroyModelMixin"><span class="toc-text">e. DestroyModelMixin</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-10-ViewSet%E8%A7%86%E5%9B%BE%E9%9B%86"><span class="toc-text">1.10 ViewSet视图集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84ViewSet%E5%8A%A8%E4%BD%9C"><span class="toc-text">常见的ViewSet动作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%B7%AF%E7%94%B1"><span class="toc-text">设置路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#action%E5%B1%9E%E6%80%A7"><span class="toc-text">action属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E8%A7%86%E5%9B%BE%E9%9B%86%E7%88%B6%E7%B1%BB"><span class="toc-text">常用视图集父类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E9%99%84%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E4%BD%9C"><span class="toc-text">定义附加自定义动作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E4%BD%9C%E7%9A%84%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0"><span class="toc-text">自定义动作的路由参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%E4%B8%8E%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-text">参数校验与错误处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-11-Router%E7%B1%BB"><span class="toc-text">1.11 Router类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%A4%E7%A7%8D%E4%B8%BB%E8%A6%81%E8%B7%AF%E7%94%B1%E7%B1%BB%E5%9E%8B"><span class="toc-text">1. 两种主要路由类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1%E7%BB%91%E5%AE%9A%E7%9A%84%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91"><span class="toc-text">2. 路由绑定的核心逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E4%BD%BF%E7%94%A8-DefaultRouter-%E9%85%8D%E7%BD%AE%E6%A0%87%E5%87%86%E8%A7%86%E5%9B%BE%E9%9B%86"><span class="toc-text">a. 使用 DefaultRouter 配置标准视图集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E5%AF%B9%E5%BA%94%E7%9A%84%E8%A7%86%E5%9B%BE%E9%9B%86%E5%AE%9A%E4%B9%89"><span class="toc-text">b. 对应的视图集定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%9A%84URL%E6%A8%A1%E5%BC%8F"><span class="toc-text">c. 自动生成的URL模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-12-APIView%E5%92%8CViewSet%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text">1.12 APIView和ViewSet的选择</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-%E6%A0%B8%E5%BF%83%E5%8C%BA%E5%88%AB%EF%BC%9A%E4%BB%8E%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87%E7%90%86%E8%A7%A3"><span class="toc-text">a. 核心区别：从设计目标理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF%E5%AF%B9%E6%AF%94"><span class="toc-text">b. 适用场景对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B%E5%AF%B9%E6%AF%94"><span class="toc-text">c. 实战案例对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#d-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%EF%BC%9A%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8-APIView-%E5%92%8C-ViewSet"><span class="toc-text">d. 高级技巧：混合使用 APIView 和 ViewSet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#e-%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE%EF%BC%9A%E4%BB%8E%E9%9C%80%E6%B1%82%E5%87%BA%E5%8F%91"><span class="toc-text">e. 选择建议：从需求出发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#f-%E6%80%BB%E7%BB%93%EF%BC%9A%E8%AE%BE%E8%AE%A1%E6%9D%83%E8%A1%A1"><span class="toc-text">f. 总结：设计权衡</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B6%E4%BB%96%E7%B3%BB%E7%BB%9F%E5%8A%9F%E8%83%BD"><span class="toc-text">2. 其他系统功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%9D%83%E9%99%90Permissions"><span class="toc-text">2.1 权限Permissions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%AE%A4%E8%AF%81Authentication"><span class="toc-text">2.2 认证Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%85%B6%E4%BB%96%E6%96%B0%E5%8A%9F%E8%83%BD"><span class="toc-text">2.3 其他新功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%87%B4%E8%B0%A2"><span class="toc-text">3. 致谢</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/25/framwork-kuang-jia-xue-xi/" title="Django REST framwork框架学习"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Django REST framwork框架学习"/></a><div class="content"><a class="title" href="/2025/06/25/framwork-kuang-jia-xue-xi/" title="Django REST framwork框架学习">Django REST framwork框架学习</a><time datetime="2025-06-25T13:09:01.000Z" title="发表于 2025-06-25 21:09:01">2025-06-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/19/wide-deep-mo-xing/" title="Wide&amp;Deep模型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Wide&amp;Deep模型"/></a><div class="content"><a class="title" href="/2025/06/19/wide-deep-mo-xing/" title="Wide&amp;Deep模型">Wide&amp;Deep模型</a><time datetime="2025-06-19T05:30:40.000Z" title="发表于 2025-06-19 13:30:40">2025-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/08/java-ji-chu-xia/" title="Java基础下"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java基础下"/></a><div class="content"><a class="title" href="/2025/03/08/java-ji-chu-xia/" title="Java基础下">Java基础下</a><time datetime="2025-03-08T03:43:21.000Z" title="发表于 2025-03-08 11:43:21">2025-03-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/08/duo-xian-cheng-e-wai-kuo-zhan/" title="Java基础之多线程"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java基础之多线程"/></a><div class="content"><a class="title" href="/2025/03/08/duo-xian-cheng-e-wai-kuo-zhan/" title="Java基础之多线程">Java基础之多线程</a><time datetime="2025-03-08T03:43:21.000Z" title="发表于 2025-03-08 11:43:21">2025-03-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/07/qian-ru-shi-xi-tong-gai-shu/" title="嵌入式系统概述"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="嵌入式系统概述"/></a><div class="content"><a class="title" href="/2025/03/07/qian-ru-shi-xi-tong-gai-shu/" title="嵌入式系统概述">嵌入式系统概述</a><time datetime="2025-03-07T06:08:48.000Z" title="发表于 2025-03-07 14:08:48">2025-03-07</time></div></div></div></div></div></div><!-- 登录验证模态框--></main><footer id="footer" style="background-image: url(/img/footer.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By 0zxm</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- CSS 样式--><style>#login-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.modal-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  cursor: pointer;
}

.modal-content {
  background-color: white;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  width: 80%;
  max-width: 400px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  z-index:999;
}

input#password-input {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  margin-bottom: 20px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

button#submit-btn {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button#submit-btn:hover {
  background-color: #45a049;
}
</style><!-- JavaScript 验证--><script>document.addEventListener('DOMContentLoaded', function() {

  (function() {
  // 禁用右键菜单
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    return false;
  });

  // 禁用快捷键 (F12/Ctrl+Shift+I/Ctrl+Shift+J/Ctrl+Shift+C)
  document.addEventListener('keydown', function(e) {
    if (e.key === 'F12' || 
        (e.ctrlKey && e.shiftKey && e.key === 'I') || 
        (e.ctrlKey && e.shiftKey && e.key === 'J') ||
        (e.ctrlKey && e.shiftKey && e.key === 'C')) {
      e.preventDefault();
      return false;
    }
  });
  })();
  

  const modal = document.getElementById('login-modal');
  const passwordInput = document.getElementById('password-input');
  const submitBtn = document.getElementById('submit-btn');
  const errorMsg = document.getElementById('error-msg');
  const bodyWrap = document.getElementById('body-wrap');


  // 默认显示模态框
  modal.style.display = 'flex';

  // 自动聚焦到密码输入框
  passwordInput.focus();

  submitBtn.addEventListener('click', function(e) {
    e.preventDefault();
    const password = passwordInput.value;
    const correctPassword = 'D&X'; // 替换为实际密码

    if (password === correctPassword) {
      modal.style.display = 'none';
      bodyWrap.style.opacity = 1; // 显示页面内容
    } else {
      passwordInput.classList.add('error');
      errorMsg.style.display = 'block';
      setTimeout(() => {
        passwordInput.classList.remove('error');
        errorMsg.style.display = 'none';
      }, 2000);
    }
  });
  // 按下 Enter 键提交
  passwordInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      submitBtn.click();
    }
  });
});</script></body></html>